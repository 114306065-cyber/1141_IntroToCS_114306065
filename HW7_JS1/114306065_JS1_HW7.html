<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
</head>
<body>
	<h1>114306065_HW7_1A2B</h1>
	<p>Enter 4 unique nembers
	<input id="guess" type="text">
	<input type="button" id="inputbutton" value="Guess!" onclick="generateAnswer();play()"></p>
	<p id="record"></p>
	<p id="hint"></p>
	<script>
		let ans = "";
		var count = 0;
		let resultstr ="";
		function generateAnswer() {    	
      	while (ans.length < 4) {
      		let digit = Math.floor(Math.random() * 10);
        	if (!ans.includes(digit)) {
        	ans += digit;
        }
      }
    	return ans;
    }

    function play() {
    document.getElementById("record").innerHTML = "Game Record:<br>";
    const inputBox = document.getElementById("guess");
      let guessInput = inputBox.value.trim();


      function isValid(guessInput) {
    	if (guessInput.length !== 4) {
    		return false;
    	}
    	for (var i = 0; i < guessInput.length; i++) {
    		for (var j = i + 1; j < guessInput.length; j++) {
      			if(guessInput[j] === guessInput[i]){
      				return false;
      			}
     		}
     	}
    }

      if (isValid(guessInput) === false) {
        alert("請輸入四位不重複數字");
        return;
      }else {
      	count++;
      }


      let result = checkAB(guessInput, ans);
      
      resultstr += `${count}. ${guessInput} → ${result}<br>`;

      document.getElementById("hint").innerHTML = resultstr ;

      if (result === "4A0B") {
      	resetGame();
    	alert(`成功了! 你嘗試了${count}次`);
    	count=0;
    }
      
    


    function checkAB(guessInput, ans) {
      let A = 0;
      let B = 0;

      for (let i = 0; i < 4; i++) {
        if (guessInput[i] === ans[i]) {
          A++;
        } else if (ans.includes(guessInput[i])) {
          B++;
        }
      }
      return `${A}A${B}B`;
    }

    function resetGame() {
    ans = "";          // 清空答案
    generateAnswer();  // 重產生新答案
    document.getElementById("record").innerHTML = "";
    document.getElementById("hint").innerHTML = "";  // 清空紀錄
    document.getElementById("guess").value = ""; 
    resultstr="";      // 清空輸入框
}
document.getElementById("guess").value = "";
}
	</script>
</body>
</html>